{% extends "base.html" %}
{% load static %}
{% block title %}Resumen de Licencias{% endblock %}

{% block content %}

<header id="header-prin-lic" style="padding-top: 20px;">
    <nav id="header-vl">
        <ul class="VL-header">
            <a href="{% url 'inicio' %}" class="atras-vl btn btn-outline-danger">
                <i class="bi bi-arrow-left"></i>
            </a>

            <a href="{% url 'licencias_chart' %}" class="atras-vl btn btn-outline-warning" style="margin-left: 200%;">
                <i class="bi bi-eye-fill"></i> 
            </a>
        </ul>
    </nav>
    <img src="{% static 'images/sinapsis_icono.ico' %}" class="logo">
</header>

<div id="encabezado-ver-licencias">
    <h3>Ver Licencias</h3>
    <i id="check-lic" class="bi bi-clipboard-check"></i>
</div>

<br>

<div class="container mt-5">
    <h2 class="mb-4">Resumen de Licencias</h2>

    <div class="table-responsive">
        <table class="table table-bordered table-hover">
            <thead class="table-dark">
                <tr>
                    <th>Fecha Inicio</th>
                    <th>Nombre Completo</th>
                    <th>Cédula</th>
                    <th>Área</th>
                    <th>Fecha Fin</th>
                    <th>Motivo</th>
                    <th>Estado</th>
                    <th>Creado por</th>
                </tr>
            </thead>
            <tbody id="tabla-cuerpo-licencias">
                <!-- Relleno dinámico desde JS -->
            </tbody>
        </table>
    </div>
</div>

<script >
    document.addEventListener("DOMContentLoaded", function () {
    fetch("/api/solicitudes/")
        .then(response => response.json())
        .then(data => {
            const cuerpoTabla = document.getElementById("tabla-cuerpo-licencias");
            cuerpoTabla.innerHTML = "";

            data.forEach(licencia => {
                const fila = document.createElement("tr");
                fila.innerHTML = `
                    <td>${licencia.fecha_inicio}</td>
                    <td>${licencia.nombre_completo}</td>
                    <td>${licencia.cedula}</td>
                    <td>${licencia.area}</td>
                    <td>${licencia.fecha_fin}</td>
                    <td>${licencia.motivo_licencia}</td>
                    <td>${licencia.estado}</td>
                    <td>${licencia.creada_por}</td>
                `;
                cuerpoTabla.appendChild(fila);
            });
        })
        .catch(error => console.error("Error al cargar licencias:", error));
});
</script>

{% endblock %}
